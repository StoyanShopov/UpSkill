{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = isStrongPassword;\n\nvar _merge = _interopRequireDefault(require(\"./util/merge\"));\n\nvar _assertString = _interopRequireDefault(require(\"./util/assertString\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar upperCaseRegex = /^[A-Z]$/;\nvar lowerCaseRegex = /^[a-z]$/;\nvar numberRegex = /^[0-9]$/;\nvar symbolRegex = /^[-#!$@%^&*()_+|~=`{}\\[\\]:\";'<>?,.\\/ ]$/;\nvar defaultOptions = {\n  minLength: 8,\n  minLowercase: 1,\n  minUppercase: 1,\n  minNumbers: 1,\n  minSymbols: 1,\n  returnScore: false,\n  pointsPerUnique: 1,\n  pointsPerRepeat: 0.5,\n  pointsForContainingLower: 10,\n  pointsForContainingUpper: 10,\n  pointsForContainingNumber: 10,\n  pointsForContainingSymbol: 10\n};\n/* Counts number of occurrences of each char in a string\n * could be moved to util/ ?\n*/\n\nfunction countChars(str) {\n  var result = {};\n  Array.from(str).forEach(function (char) {\n    var curVal = result[char];\n\n    if (curVal) {\n      result[char] += 1;\n    } else {\n      result[char] = 1;\n    }\n  });\n  return result;\n}\n/* Return information about a password */\n\n\nfunction analyzePassword(password) {\n  var charMap = countChars(password);\n  var analysis = {\n    length: password.length,\n    uniqueChars: Object.keys(charMap).length,\n    uppercaseCount: 0,\n    lowercaseCount: 0,\n    numberCount: 0,\n    symbolCount: 0\n  };\n  Object.keys(charMap).forEach(function (char) {\n    /* istanbul ignore else */\n    if (upperCaseRegex.test(char)) {\n      analysis.uppercaseCount += charMap[char];\n    } else if (lowerCaseRegex.test(char)) {\n      analysis.lowercaseCount += charMap[char];\n    } else if (numberRegex.test(char)) {\n      analysis.numberCount += charMap[char];\n    } else if (symbolRegex.test(char)) {\n      analysis.symbolCount += charMap[char];\n    }\n  });\n  return analysis;\n}\n\nfunction scorePassword(analysis, scoringOptions) {\n  var points = 0;\n  points += analysis.uniqueChars * scoringOptions.pointsPerUnique;\n  points += (analysis.length - analysis.uniqueChars) * scoringOptions.pointsPerRepeat;\n\n  if (analysis.lowercaseCount > 0) {\n    points += scoringOptions.pointsForContainingLower;\n  }\n\n  if (analysis.uppercaseCount > 0) {\n    points += scoringOptions.pointsForContainingUpper;\n  }\n\n  if (analysis.numberCount > 0) {\n    points += scoringOptions.pointsForContainingNumber;\n  }\n\n  if (analysis.symbolCount > 0) {\n    points += scoringOptions.pointsForContainingSymbol;\n  }\n\n  return points;\n}\n\nfunction isStrongPassword(str) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  (0, _assertString.default)(str);\n  var analysis = analyzePassword(str);\n  options = (0, _merge.default)(options || {}, defaultOptions);\n\n  if (options.returnScore) {\n    return scorePassword(analysis, options);\n  }\n\n  return analysis.length >= options.minLength && analysis.lowercaseCount >= options.minLowercase && analysis.uppercaseCount >= options.minUppercase && analysis.numberCount >= options.minNumbers && analysis.symbolCount >= options.minSymbols;\n}\n\nmodule.exports = exports.default;\nmodule.exports.default = exports.default;","map":{"version":3,"sources":["H:/Programming Repositories/Titans/Web/UpSkill.Web/ClientApp/node_modules/validator/lib/isStrongPassword.js"],"names":["Object","defineProperty","exports","value","default","isStrongPassword","_merge","_interopRequireDefault","require","_assertString","obj","__esModule","upperCaseRegex","lowerCaseRegex","numberRegex","symbolRegex","defaultOptions","minLength","minLowercase","minUppercase","minNumbers","minSymbols","returnScore","pointsPerUnique","pointsPerRepeat","pointsForContainingLower","pointsForContainingUpper","pointsForContainingNumber","pointsForContainingSymbol","countChars","str","result","Array","from","forEach","char","curVal","analyzePassword","password","charMap","analysis","length","uniqueChars","keys","uppercaseCount","lowercaseCount","numberCount","symbolCount","test","scorePassword","scoringOptions","points","options","arguments","undefined","module"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;AAGAD,OAAO,CAACE,OAAR,GAAkBC,gBAAlB;;AAEA,IAAIC,MAAM,GAAGC,sBAAsB,CAACC,OAAO,CAAC,cAAD,CAAR,CAAnC;;AAEA,IAAIC,aAAa,GAAGF,sBAAsB,CAACC,OAAO,CAAC,qBAAD,CAAR,CAA1C;;AAEA,SAASD,sBAAT,CAAgCG,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AAAEN,IAAAA,OAAO,EAAEM;AAAX,GAArC;AAAwD;;AAE/F,IAAIE,cAAc,GAAG,SAArB;AACA,IAAIC,cAAc,GAAG,SAArB;AACA,IAAIC,WAAW,GAAG,SAAlB;AACA,IAAIC,WAAW,GAAG,yCAAlB;AACA,IAAIC,cAAc,GAAG;AACnBC,EAAAA,SAAS,EAAE,CADQ;AAEnBC,EAAAA,YAAY,EAAE,CAFK;AAGnBC,EAAAA,YAAY,EAAE,CAHK;AAInBC,EAAAA,UAAU,EAAE,CAJO;AAKnBC,EAAAA,UAAU,EAAE,CALO;AAMnBC,EAAAA,WAAW,EAAE,KANM;AAOnBC,EAAAA,eAAe,EAAE,CAPE;AAQnBC,EAAAA,eAAe,EAAE,GARE;AASnBC,EAAAA,wBAAwB,EAAE,EATP;AAUnBC,EAAAA,wBAAwB,EAAE,EAVP;AAWnBC,EAAAA,yBAAyB,EAAE,EAXR;AAYnBC,EAAAA,yBAAyB,EAAE;AAZR,CAArB;AAcA;AACA;AACA;;AAEA,SAASC,UAAT,CAAoBC,GAApB,EAAyB;AACvB,MAAIC,MAAM,GAAG,EAAb;AACAC,EAAAA,KAAK,CAACC,IAAN,CAAWH,GAAX,EAAgBI,OAAhB,CAAwB,UAAUC,IAAV,EAAgB;AACtC,QAAIC,MAAM,GAAGL,MAAM,CAACI,IAAD,CAAnB;;AAEA,QAAIC,MAAJ,EAAY;AACVL,MAAAA,MAAM,CAACI,IAAD,CAAN,IAAgB,CAAhB;AACD,KAFD,MAEO;AACLJ,MAAAA,MAAM,CAACI,IAAD,CAAN,GAAe,CAAf;AACD;AACF,GARD;AASA,SAAOJ,MAAP;AACD;AACD;;;AAGA,SAASM,eAAT,CAAyBC,QAAzB,EAAmC;AACjC,MAAIC,OAAO,GAAGV,UAAU,CAACS,QAAD,CAAxB;AACA,MAAIE,QAAQ,GAAG;AACbC,IAAAA,MAAM,EAAEH,QAAQ,CAACG,MADJ;AAEbC,IAAAA,WAAW,EAAE1C,MAAM,CAAC2C,IAAP,CAAYJ,OAAZ,EAAqBE,MAFrB;AAGbG,IAAAA,cAAc,EAAE,CAHH;AAIbC,IAAAA,cAAc,EAAE,CAJH;AAKbC,IAAAA,WAAW,EAAE,CALA;AAMbC,IAAAA,WAAW,EAAE;AANA,GAAf;AAQA/C,EAAAA,MAAM,CAAC2C,IAAP,CAAYJ,OAAZ,EAAqBL,OAArB,CAA6B,UAAUC,IAAV,EAAgB;AAC3C;AACA,QAAIvB,cAAc,CAACoC,IAAf,CAAoBb,IAApB,CAAJ,EAA+B;AAC7BK,MAAAA,QAAQ,CAACI,cAAT,IAA2BL,OAAO,CAACJ,IAAD,CAAlC;AACD,KAFD,MAEO,IAAItB,cAAc,CAACmC,IAAf,CAAoBb,IAApB,CAAJ,EAA+B;AACpCK,MAAAA,QAAQ,CAACK,cAAT,IAA2BN,OAAO,CAACJ,IAAD,CAAlC;AACD,KAFM,MAEA,IAAIrB,WAAW,CAACkC,IAAZ,CAAiBb,IAAjB,CAAJ,EAA4B;AACjCK,MAAAA,QAAQ,CAACM,WAAT,IAAwBP,OAAO,CAACJ,IAAD,CAA/B;AACD,KAFM,MAEA,IAAIpB,WAAW,CAACiC,IAAZ,CAAiBb,IAAjB,CAAJ,EAA4B;AACjCK,MAAAA,QAAQ,CAACO,WAAT,IAAwBR,OAAO,CAACJ,IAAD,CAA/B;AACD;AACF,GAXD;AAYA,SAAOK,QAAP;AACD;;AAED,SAASS,aAAT,CAAuBT,QAAvB,EAAiCU,cAAjC,EAAiD;AAC/C,MAAIC,MAAM,GAAG,CAAb;AACAA,EAAAA,MAAM,IAAIX,QAAQ,CAACE,WAAT,GAAuBQ,cAAc,CAAC3B,eAAhD;AACA4B,EAAAA,MAAM,IAAI,CAACX,QAAQ,CAACC,MAAT,GAAkBD,QAAQ,CAACE,WAA5B,IAA2CQ,cAAc,CAAC1B,eAApE;;AAEA,MAAIgB,QAAQ,CAACK,cAAT,GAA0B,CAA9B,EAAiC;AAC/BM,IAAAA,MAAM,IAAID,cAAc,CAACzB,wBAAzB;AACD;;AAED,MAAIe,QAAQ,CAACI,cAAT,GAA0B,CAA9B,EAAiC;AAC/BO,IAAAA,MAAM,IAAID,cAAc,CAACxB,wBAAzB;AACD;;AAED,MAAIc,QAAQ,CAACM,WAAT,GAAuB,CAA3B,EAA8B;AAC5BK,IAAAA,MAAM,IAAID,cAAc,CAACvB,yBAAzB;AACD;;AAED,MAAIa,QAAQ,CAACO,WAAT,GAAuB,CAA3B,EAA8B;AAC5BI,IAAAA,MAAM,IAAID,cAAc,CAACtB,yBAAzB;AACD;;AAED,SAAOuB,MAAP;AACD;;AAED,SAAS9C,gBAAT,CAA0ByB,GAA1B,EAA+B;AAC7B,MAAIsB,OAAO,GAAGC,SAAS,CAACZ,MAAV,GAAmB,CAAnB,IAAwBY,SAAS,CAAC,CAAD,CAAT,KAAiBC,SAAzC,GAAqDD,SAAS,CAAC,CAAD,CAA9D,GAAoE,IAAlF;AACA,GAAC,GAAG5C,aAAa,CAACL,OAAlB,EAA2B0B,GAA3B;AACA,MAAIU,QAAQ,GAAGH,eAAe,CAACP,GAAD,CAA9B;AACAsB,EAAAA,OAAO,GAAG,CAAC,GAAG9C,MAAM,CAACF,OAAX,EAAoBgD,OAAO,IAAI,EAA/B,EAAmCpC,cAAnC,CAAV;;AAEA,MAAIoC,OAAO,CAAC9B,WAAZ,EAAyB;AACvB,WAAO2B,aAAa,CAACT,QAAD,EAAWY,OAAX,CAApB;AACD;;AAED,SAAOZ,QAAQ,CAACC,MAAT,IAAmBW,OAAO,CAACnC,SAA3B,IAAwCuB,QAAQ,CAACK,cAAT,IAA2BO,OAAO,CAAClC,YAA3E,IAA2FsB,QAAQ,CAACI,cAAT,IAA2BQ,OAAO,CAACjC,YAA9H,IAA8IqB,QAAQ,CAACM,WAAT,IAAwBM,OAAO,CAAChC,UAA9K,IAA4LoB,QAAQ,CAACO,WAAT,IAAwBK,OAAO,CAAC/B,UAAnO;AACD;;AAEDkC,MAAM,CAACrD,OAAP,GAAiBA,OAAO,CAACE,OAAzB;AACAmD,MAAM,CAACrD,OAAP,CAAeE,OAAf,GAAyBF,OAAO,CAACE,OAAjC","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = isStrongPassword;\n\nvar _merge = _interopRequireDefault(require(\"./util/merge\"));\n\nvar _assertString = _interopRequireDefault(require(\"./util/assertString\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar upperCaseRegex = /^[A-Z]$/;\nvar lowerCaseRegex = /^[a-z]$/;\nvar numberRegex = /^[0-9]$/;\nvar symbolRegex = /^[-#!$@%^&*()_+|~=`{}\\[\\]:\";'<>?,.\\/ ]$/;\nvar defaultOptions = {\n  minLength: 8,\n  minLowercase: 1,\n  minUppercase: 1,\n  minNumbers: 1,\n  minSymbols: 1,\n  returnScore: false,\n  pointsPerUnique: 1,\n  pointsPerRepeat: 0.5,\n  pointsForContainingLower: 10,\n  pointsForContainingUpper: 10,\n  pointsForContainingNumber: 10,\n  pointsForContainingSymbol: 10\n};\n/* Counts number of occurrences of each char in a string\n * could be moved to util/ ?\n*/\n\nfunction countChars(str) {\n  var result = {};\n  Array.from(str).forEach(function (char) {\n    var curVal = result[char];\n\n    if (curVal) {\n      result[char] += 1;\n    } else {\n      result[char] = 1;\n    }\n  });\n  return result;\n}\n/* Return information about a password */\n\n\nfunction analyzePassword(password) {\n  var charMap = countChars(password);\n  var analysis = {\n    length: password.length,\n    uniqueChars: Object.keys(charMap).length,\n    uppercaseCount: 0,\n    lowercaseCount: 0,\n    numberCount: 0,\n    symbolCount: 0\n  };\n  Object.keys(charMap).forEach(function (char) {\n    /* istanbul ignore else */\n    if (upperCaseRegex.test(char)) {\n      analysis.uppercaseCount += charMap[char];\n    } else if (lowerCaseRegex.test(char)) {\n      analysis.lowercaseCount += charMap[char];\n    } else if (numberRegex.test(char)) {\n      analysis.numberCount += charMap[char];\n    } else if (symbolRegex.test(char)) {\n      analysis.symbolCount += charMap[char];\n    }\n  });\n  return analysis;\n}\n\nfunction scorePassword(analysis, scoringOptions) {\n  var points = 0;\n  points += analysis.uniqueChars * scoringOptions.pointsPerUnique;\n  points += (analysis.length - analysis.uniqueChars) * scoringOptions.pointsPerRepeat;\n\n  if (analysis.lowercaseCount > 0) {\n    points += scoringOptions.pointsForContainingLower;\n  }\n\n  if (analysis.uppercaseCount > 0) {\n    points += scoringOptions.pointsForContainingUpper;\n  }\n\n  if (analysis.numberCount > 0) {\n    points += scoringOptions.pointsForContainingNumber;\n  }\n\n  if (analysis.symbolCount > 0) {\n    points += scoringOptions.pointsForContainingSymbol;\n  }\n\n  return points;\n}\n\nfunction isStrongPassword(str) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  (0, _assertString.default)(str);\n  var analysis = analyzePassword(str);\n  options = (0, _merge.default)(options || {}, defaultOptions);\n\n  if (options.returnScore) {\n    return scorePassword(analysis, options);\n  }\n\n  return analysis.length >= options.minLength && analysis.lowercaseCount >= options.minLowercase && analysis.uppercaseCount >= options.minUppercase && analysis.numberCount >= options.minNumbers && analysis.symbolCount >= options.minSymbols;\n}\n\nmodule.exports = exports.default;\nmodule.exports.default = exports.default;"]},"metadata":{},"sourceType":"script"}